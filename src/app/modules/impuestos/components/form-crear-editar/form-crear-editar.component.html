<form [formGroup]="form" (onSubmit)="createUpdateTax()">
  <div class="col-12">
    <div class="formgrid grid">
      <div *ngIf="!data" class="field col-12 md:col-4">
        <label for="codigo" class="font-semibold">Código</label>
        <input
          id="codigo"
          pInputText
          class="w-full"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_code'].touched &&
              form.controls['tax_code'].invalid
          }"
          formControlName="tax_code"
          aria-describedby="codigo-help"
          maxlength="10" />
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_code'].touched &&
            form.controls['tax_code'].invalid &&
            form.controls['tax_code'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_code'].invalid &&
            form.controls['tax_code'].hasError('minlength')
          "
          id="codigo-help">
          Mínimo
          {{
            form.controls['tax_code'].errors?.['minlength']?.requiredLength ?? 0
          }}
          caracteres
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_code'].invalid &&
            form.controls['tax_code'].hasError('maxlength')
          "
          id="codigo-help">
          Máximo
          {{
            form.controls['tax_code'].errors?.['maxlength']?.requiredLength ?? 0
          }}
          caracteres
        </small>
      </div>

      <div class="field col-12" [ngClass]="!data ? 'md:col-8' : 'md:col-12'">
        <label for="descripcion" class="font-semibold">Descripción</label>
        <input
          id="descripcion"
          pInputText
          class="w-full"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_description'].touched &&
              form.controls['tax_description'].invalid
          }"
          formControlName="tax_description"
          maxlength="80" />

        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_description'].touched &&
            form.controls['tax_description'].invalid &&
            form.controls['tax_description'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_description'].invalid &&
            form.controls['tax_description'].hasError('minlength')
          "
          id="codigo-help">
          Mínimo
          {{
            form.controls['tax_description'].errors?.['minlength']
              ?.requiredLength ?? 0
          }}
          caracteres
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_description'].invalid &&
            form.controls['tax_description'].hasError('maxlength')
          "
          id="codigo-help">
          Máximo
          {{
            form.controls['tax_description'].errors?.['maxlength']
              ?.requiredLength ?? 0
          }}
          caracteres
        </small>
      </div>

      <div class="field col-12 sm:col-6 md:col-3">
        <label for="siglas" class="font-semibold">Siglas</label>
        <input
          id="siglas"
          pInputText
          class="w-full"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_siglas'].touched &&
              form.controls['tax_siglas'].invalid
          }"
          formControlName="tax_siglas"
          maxlength="150" />

        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_siglas'].touched &&
            form.controls['tax_siglas'].invalid &&
            form.controls['tax_siglas'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_siglas'].invalid &&
            form.controls['tax_siglas'].hasError('minlength')
          "
          id="codigo-help">
          Mínimo
          {{
            form.controls['tax_siglas'].errors?.['minlength']?.requiredLength ??
              0
          }}
          caracteres
        </small>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_siglas'].invalid &&
            form.controls['tax_siglas'].hasError('maxlength')
          "
          id="codigo-help">
          Máximo
          {{
            form.controls['tax_siglas'].errors?.['maxlength']?.requiredLength ??
              0
          }}
          caracteres
        </small>
      </div>

      <div class="field col-12 sm:col-6 md:col-3">
        <label class="w-full font-semibold" for="porcentaje">Porcentaje</label>
        <p-inputNumber
          id="porcentaje"
          formControlName="tax_percentage"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_percentage'].touched &&
              form.controls['tax_percentage'].invalid
          }"
          suffix=" %"
          inputStyleClass="text-right"
          [maxFractionDigits]="0"
          [maxlength]="5"
          [min]="1"
          [max]="100"></p-inputNumber>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_percentage'].touched &&
            form.controls['tax_percentage'].invalid &&
            form.controls['tax_percentage'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
      </div>

      <div class="field col-12 sm:col-6 md:col-3">
        <label class="w-full font-semibold">Tipo</label>
        <p-dropdown
          [options]="listTaxType"
          optionLabel="label"
          formControlName="tax_type"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_type'].touched &&
              form.controls['tax_type'].invalid
          }"
          styleClass="w-full"
          placeholder="Seleccione un tipo"
          (onChange)="changeType($event)"></p-dropdown>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_type'].touched &&
            form.controls['tax_type'].invalid &&
            form.controls['tax_type'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
      </div>

      <div class="field col-12 sm:col-6 md:col-3">
        <label class="w-full font-semibold">Afecta costos</label>
        <p-dropdown
          [options]="listTaxAffectsCost"
          optionLabel="label"
          formControlName="tax_affects_cost"
          styleClass="w-full"
          [ngClass]="{
            'ng-invalid ng-dirty':
              form.controls['tax_affects_cost'].touched &&
              form.controls['tax_affects_cost'].invalid
          }"
          placeholder="Seleccione una opción"
          (onChange)="changeAffectsCost($event)"></p-dropdown>
        <small
          class="p-error fadeinleft animation-duration-500"
          *ngIf="
            form.controls['tax_affects_cost'].touched &&
            form.controls['tax_affects_cost'].invalid &&
            form.controls['tax_affects_cost'].hasError('required')
          "
          id="codigo-help">
          Este campo es requerido
        </small>
      </div>

      <div *ngIf="data" class="field col-12 flex justify-content-end">
        <label for="tax_status" class="font-semibold">Activo</label>
        <p-inputSwitch
          inputId="tax_status"
          class="ml-2"
          formControlName="tax_status"
          (onChange)="changeStatus($event)"></p-inputSwitch>
      </div>

      <div
        class="field col-12 flex justify-content-end align-items-center gap-2 mb-0">
        <p-button
          label="Cancelar"
          styleClass="p-button-danger"
          (click)="dialogRef.close(false)"></p-button>
        <p-button label="Guardar" (click)="createUpdateTax()"></p-button>
      </div>
    </div>
  </div>
</form>
